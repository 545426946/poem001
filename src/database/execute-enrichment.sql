-- Supabase数据库丰富脚本
-- 执行数据插入操作

-- 首先检查表结构是否存在，如果不存在则创建
CREATE TABLE IF NOT EXISTS poems (
    id SERIAL PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    author VARCHAR(100) NOT NULL,
    dynasty VARCHAR(50) NOT NULL,
    content TEXT NOT NULL,
    translation TEXT,
    appreciation TEXT,
    background TEXT,
    keywords TEXT[],
    difficulty VARCHAR(20) DEFAULT 'beginner',
    category VARCHAR(50),
    tags TEXT[],
    literary_devices TEXT[],
    themes TEXT[],
    study_count INTEGER DEFAULT 0,
    like_count INTEGER DEFAULT 0,
    view_count INTEGER DEFAULT 0,
    popularity INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS poets (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    dynasty VARCHAR(50),
    biography TEXT,
    works_count INTEGER DEFAULT 0,
    popularity INTEGER DEFAULT 0,
    tags TEXT[],
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 插入丰富的诗词数据
INSERT INTO poems (title, author, dynasty, content, translation, appreciation, background, keywords, difficulty, category, tags, literary_devices, themes, study_count, like_count, view_count, popularity) VALUES
('静夜思', '李白', '唐代', '床前明月光，疑是地上霜。举头望明月，低头思故乡。', 
 '明亮的月光洒在床前，好像地上泛起了一层白霜。我抬起头来看着明月，不由得低头思念起故乡。',
 '这首诗通过简洁的语言描绘了游子思乡之情，意境深远，语言优美。',
 '李白在扬州旅舍时所作，表达了对故乡的深切思念。',
 ARRAY['思乡', '明月', '故乡'], 'beginner', '抒情', 
 ARRAY['思乡', '明月', '唐诗'], ARRAY['比喻', '对偶'], ARRAY['思乡', '孤独'], 
 1500, 800, 3000, 90),

('春晓', '孟浩然', '唐代', '春眠不觉晓，处处闻啼鸟。夜来风雨声，花落知多少。',
 '春天睡醒不觉天已大亮，到处是鸟儿清脆的叫声。回想昨夜的阵阵风雨，不知道吹落了多少花朵。',
 '描绘春天早晨的景色，语言清新自然，意境优美。',
 '孟浩然隐居鹿门山时所作，表现了对大自然的热爱。',
 ARRAY['春天', '鸟鸣', '风雨'], 'beginner', '写景',
 ARRAY['春天', '自然', '唐诗'], ARRAY['拟人', '对比'], ARRAY['自然', '时光'],
 1200, 600, 2500, 85),

('登鹳雀楼', '王之涣', '唐代', '白日依山尽，黄河入海流。欲穷千里目，更上一层楼。',
 '夕阳依傍着西山慢慢沉落，滔滔黄河朝着东海汹涌奔流。想要看到千里之外的风光，那就要再登上更高的一层楼。',
 '这首诗描绘了壮丽的自然景色，并寓含积极向上的人生哲理。',
 '王之涣登鹳雀楼时所作，表达了对壮丽河山的热爱和进取精神。',
 ARRAY['登高', '黄河', '进取'], 'intermediate', '抒情',
 ARRAY['登高', '黄河', '唐诗'], ARRAY['对偶', '夸张'], ARRAY['进取', '壮丽'],
 800, 400, 1800, 80),

('望岳', '杜甫', '唐代', '岱宗夫如何？齐鲁青未了。造化钟神秀，阴阳割昏晓。荡胸生曾云，决眦入归鸟。会当凌绝顶，一览众山小。',
 '泰山到底怎么样？在齐鲁大地上，那青翠的山色没有尽头。大自然把神奇秀丽的景色都汇聚于泰山，山南和山北的天色被分割为一明一暗两部分。冉冉升起的云霞荡涤我的心灵，睁大眼睛追踪那暮归的鸟儿隐入山林。我一定要登上泰山的顶峰，俯瞰那众山，而众山在我眼中是多么的渺小。',
 '这首诗通过描绘泰山的雄伟壮丽，表达了诗人不怕困难、敢于攀登绝顶、俯视一切的雄心和气概。',
 '杜甫青年时期漫游齐赵时所作，展现了他的豪情壮志。',
 ARRAY['泰山', '登高', '壮志'], 'intermediate', '抒情',
 ARRAY['泰山', '登高', '唐诗'], ARRAY['夸张', '对偶'], ARRAY['壮志', '自然'],
 850, 420, 1800, 82),

('水调歌头·明月几时有', '苏轼', '宋代', '明月几时有？把酒问青天。不知天上宫阙，今夕是何年。我欲乘风归去，又恐琼楼玉宇，高处不胜寒。起舞弄清影，何似在人间。转朱阁，低绮户，照无眠。不应有恨，何事长向别时圆？人有悲欢离合，月有阴晴圆缺，此事古难全。但愿人长久，千里共婵娟。',
 '明月从什么时候开始有的呢？我拿着酒杯遥问苍天。不知道天上的宫殿，今晚是哪一年。我想凭借着风力回到天上去看一看，又担心美玉砌成的楼宇太高，我经受不住寒冷。起身舞蹈玩赏着月光下自己清朗的影子，月宫哪里比得上在人间。月儿转过朱红色的楼阁，低低地挂在雕花的窗户上，照着没有睡意的自己。明月不该对人们有什么怨恨吧，为什么偏在人们离别时才圆呢？人有悲欢离合的变迁，月有阴晴圆缺的转换，这种事自古来难以周全。只希望这世上所有人的亲人能平安健康，即便相隔千里，也能共享这美好的月光。',
 '这首词以月起兴，围绕中秋明月展开想象和思考，把人世间的悲欢离合之情纳入对宇宙人生的哲理性追寻之中，表达了词人对亲人的思念和美好祝愿。',
 '苏轼在密州任太守时中秋望月怀人之作，是中秋词的经典。',
 ARRAY['中秋', '明月', '思念'], 'advanced', '抒情',
 ARRAY['中秋', '明月', '宋词'], ARRAY['想象', '哲理'], ARRAY['思念', '人生'],
 1200, 600, 2500, 88),

('声声慢·寻寻觅觅', '李清照', '宋代', '寻寻觅觅，冷冷清清，凄凄惨惨戚戚。乍暖还寒时候，最难将息。三杯两盏淡酒，怎敌他、晚来风急？雁过也，正伤心，却是旧时相识。满地黄花堆积。憔悴损，如今有谁堪摘？守着窗儿，独自怎生得黑？梧桐更兼细雨，到黄昏、点点滴滴。这次第，怎一个愁字了得！',
 '苦苦地寻寻觅觅，却只见冷冷清清，怎不让人凄惨悲戚。秋天总是忽然变暖，又转寒冷，最难保养休息。喝三杯两杯淡酒，怎么能抵得住傍晚的寒风急袭？一行大雁从眼前飞过，更让人伤心，因为都是旧日的相识。园中菊花堆积满地，都已经憔悴不堪，如今还有谁来采摘？孤独地守着窗前，独自一个人怎么熬到天黑？梧桐叶上细雨淋漓，到黄昏时分，那雨声还是点点滴滴。这般光景，怎么能用一个"愁"字了结！',
 '这首词通过描写残秋所见、所闻、所感，抒发自己因国破家亡、天涯沦落而产生的孤寂落寞、悲凉愁苦的心绪，具有浓厚的时代色彩。',
 '李清照晚年流落江南时所作，表达了对故国和亡夫的深切思念。',
 ARRAY['秋愁', '孤独', '思念'], 'advanced', '抒情',
 ARRAY['秋愁', '孤独', '宋词'], ARRAY['叠字', '借景抒情'], ARRAY['孤独', '思念'],
 900, 450, 1800, 85),

('天净沙·秋思', '马致远', '元代', '枯藤老树昏鸦，小桥流水人家，古道西风瘦马。夕阳西下，断肠人在天涯。',
 '天色黄昏，一群乌鸦落在枯藤缠绕的老树上，发出凄厉的哀鸣。小桥下流水哗哗作响，小桥边庄户人家炊烟袅袅。古道上一匹瘦马，顶着西风艰难地前行。夕阳渐渐地失去了光泽，从西边落下。凄寒的夜色里，只有孤独的旅人漂泊在遥远的地方。',
 '这首小令很短，一共只有五句二十八个字，全曲无一"秋"字，但却描绘出一幅凄凉动人的秋郊夕照图，并且准确地传达出旅人凄苦的心境。',
 '马致远漂泊异乡时所作，是元曲中的经典。',
 ARRAY['秋思', '旅途', '孤独'], 'intermediate', '抒情',
 ARRAY['秋思', '旅途', '元曲'], ARRAY['白描', '意象叠加'], ARRAY['孤独', '思乡'],
 750, 380, 1600, 79);

-- 插入诗人数据
INSERT INTO poets (name, dynasty, biography, works_count, popularity, tags) VALUES
('李白', '唐代', '李白（701年－762年），字太白，号青莲居士，唐朝浪漫主义诗人，被后人誉为"诗仙"。其诗风格豪放飘逸，想象丰富，语言流转自然，音律和谐多变。', 1000, 95, ARRAY['诗仙', '浪漫主义', '豪放']),
('杜甫', '唐代', '杜甫（712年－770年），字子美，自号少陵野老，唐代伟大的现实主义诗人，被尊称为"诗圣"。他的诗被称为"诗史"。', 1400, 92, ARRAY['诗圣', '现实主义', '沉郁']),
('苏轼', '宋代', '苏轼（1037年－1101年），字子瞻，号东坡居士，北宋著名文学家、书法家、画家。其诗、词、散文均有很高成就。', 2700, 90, ARRAY['东坡居士', '豪放派', '文学家']),
('李清照', '宋代', '李清照（1084年－1155年），号易安居士，宋代女词人，婉约词派代表，有"千古第一才女"之称。', 78, 88, ARRAY['易安居士', '婉约派', '才女']),
('辛弃疾', '宋代', '辛弃疾（1140年－1207年），字幼安，号稼轩，南宋豪放派词人，有"词中之龙"之称。与苏轼合称"苏辛"。', 600, 89, ARRAY['稼轩', '豪放派', '爱国']);

-- 检查插入结果
SELECT '数据插入完成！' as message;
SELECT '诗词数量：' || COUNT(*) || ' 首' as poem_count FROM poems;
SELECT '诗人数量：' || COUNT(*) || ' 位' as poet_count FROM poets;

-- 显示插入的诗词列表
SELECT title, author, dynasty, difficulty FROM poems ORDER BY dynasty, author;